---
title: "Soluciones trabajo01grupotd2025"
author: "Cristóbal Delgado"
date: "2025-10-22"
output: html_document
---
# Soluciones Cristóbal Delgado

### A. Caso favorable

```{r}
source("teoriadecision_funciones_incertidumbre.R")
tabla_1 = crea.tablaX(c(,10,16,1, 8,
                      4,7,11,9, 13,
                      6,1,13,5, 12),
                    numalternativas =3,
                    numestados = 5)
knitr::kable(tabla_1)

# Aplicamos los criterios de decisión bajo incertidumbre

# Criterio de Wald (pesimista)
optimista_fav <- criterio.Wald(tabla_1, favorable = TRUE)
cat("La decisión óptima para el criterio de Wald (pesimista) es:",
    optimista_fav$AlternativaOptima)

# Criterio Optimista (Maximax)
Wald_pes_fav <- criterio.Optimista(tabla_1, favorable = TRUE)
cat("La decisión óptima para el criterio Optimista (Maximax) es:",
    Wald_pes_fav$AlternativaOptima)

# Criterio de Hurwicz
hurwicz_fav <- criterio.Hurwicz(tabla_1, alfa = 0.4, favorable = TRUE)
cat("La decisión óptima para el criterio de Hurwicz es:",
    hurwicz_fav$AlternativaOptima)

# Criterio de Savage (minimax)
savage_fav <- criterio.Savage(tabla_1, favorable = TRUE)
cat("La decisión óptima para el criterio de Savage (minimax) es:",
    savage_fav$AlternativaOptima)

# Criterio de Laplace
laplace_fav <- criterio.Laplace(tabla_1, favorable = TRUE)
cat("La decisión óptima para el criterio de Laplace es:",
    laplace_fav$AlternativaOptima)

# Criterio del Punto Ideal
puntoideal_fav <- criterio.PuntoIdeal(tabla_1, favorable = TRUE)
cat("La decisión óptima para el criterio del Punto Ideal es:",
    puntoideal_fav$AlternativaOptima)

# Dibujos de Hurwicz
dibuja.criterio.Hurwicz(tabla_1, TRUE)
grafica_fav=dibuja.criterio.Hurwicz_Intervalos(tabla_1, TRUE, TRUE)
grafica_fav

cat("El alpha donde la alternativa óptima cambia de la segunda a la primera es: ",grafica_fav$PuntosDeCorte)

```

```{r}

# Mostrar todos los criterios juntos
sol_fav=criterio.Todos(tabla_1, 0.4, favorable = TRUE)

library(tinytable)
tt(sol_fav, rownames = TRUE)

```

d2 es la alternativa más recomendada, ya que ha sido seleccionada como óptima por todos los criterios, salvo por el optimista.

### B. Caso desfavorable

```{r}
# Aplicar los criterios de decisión bajo incertidumbre

# Criterio de Wald (pesimista)
wald_pes_des <- criterio.Wald(tabla_1, favorable = FALSE)
cat("La decisión óptima para el criterio de Wald (pesimista) es:",
    wald_pes_des$AlternativaOptima)

# Criterio Optimista (Minimin)
optimista_des <- criterio.Optimista(tabla_1, favorable = FALSE)
cat("La decisión óptima para el criterio Optimista (minimin) es:",
    optimista_des$AlternativaOptima)

# Criterio de Hurwicz
hurwicz_des <- criterio.Hurwicz(tabla_1, alfa = 0.4, favorable = FALSE)
cat("La decisión óptima para el criterio de Hurwicz es:",
    hurwicz_des$AlternativaOptima)

# Criterio de Savage (minimax arrepentimiento)
savage_des <- criterio.Savage(tabla_1, favorable = FALSE)
cat("La decisión óptima para el criterio de Savage (minimax del arrepentimiento) es:",
    savage_des$AlternativaOptima)

# Criterio de Laplace (promedio equiprobable)
laplace <- criterio.Laplace(tabla_1, favorable = FALSE)
cat("La decisión óptima para el criterio de Laplace (equiprobable) es:",
    laplace$AlternativaOptima)

# Criterio del Punto Ideal
punto_ideal_des <- criterio.PuntoIdeal(tabla_1, favorable = FALSE)
cat("La decisión óptima para el criterio del Punto Ideal es:",
    punto_ideal_des$AlternativaOptima)

# Dibujos de Hurwicz
dibuja.criterio.Hurwicz(tabla_1, FALSE)
grafica_des=dibuja.criterio.Hurwicz_Intervalos(tabla_1, FALSE, TRUE)
grafica_des

cat("El alpha donde la alternativa óptima cambia de la segunda a la primera es: ",grafica_des$PuntosDeCorte)

```

```{r}
# Mostrar todos los criterios juntos
sol_des = criterio.Todos(tabla_1, 0.4, favorable = FALSE)

library(tinytable)
tt(sol_des, rownames = TRUE)

```

d3 es la alternativa más recomendada, por todos los criterios, ya que ha sido seleccionada como óptima en todas.
\newpage

## Problema 2

Una pareja quiere independizarse e irse a vivir juntos, por lo que están barajando opciones para hipotecarse. Las alternativas son las siguientes:

- Hipoteca a tipo fijo: cuotas constantes a lo largo de la vida de la hipoteca, proporciona más seguridad pero tambien cuotas más altas.
- Hipoteca a tipo variable: cuotas más bajas por lo general, pero tiene el riesgo de que el euribor suba mucho
- Hipoteca mixta: proporciona unas cuotas fijas en un periodo inicial, complementado con un periodo posterior de cuotas sujetas al euribor. Permite una previsibilidad inicial y oportunidades de tipos de interés menores, con un riesgo algo menor que a tipo variable. Se tomará un valor medio para tener en cuenta ambos periodos.

Al ir al banco, les han explicado los posibles escenarios que pueden ocurrir, para facilitar su toma de decision:
-Euríbor baja mucho: la hipoteca fija tendría un pago de 12.000 €, la variable 8.000 € y la mixta 10.000 €.

- Euríbor baja poco: la fija 12.000 €, la variable 10.000 € y la mixta 11.000 €.
- Euríbor sube poco: la fija 12.000 €, la variable 14.000 € y la mixta 13.000 €.
- Euríbor sube mucho: la fija 12.000 €, la variable 18.000 € y la mixta 15.000 €.

Después de ver las alternativas, su objetivo es sopesar cual les conviene más para ahorrar todo lo que puedan.

```{r}
tabla_2<-crea.tablaX(
  c(12000, 12000, 12000,12000,  # Hipoteca fija
    8000, 10000, 14000, 18000,  # Hipoteca variable
    10000, 11000, 13000, 15000), # Hipoteca mixta
  numalternativas = 3,
  numestados = 4,
  nb_estados= c("Euribor baja mucho", "Euribor baja poco", "Euribor sube poco", "Euribor sube mucho"),
  nb_alternativas=c("Hipoteca fija", "Hipoteca variable", "Hipoteca mixta") )

tabla_2

solucion_2 = criterio.Todos(tabla_2, 0.5, favorable = FALSE)
library(tinytable)
tt(solucion_2, rownames = TRUE)

```

Según los distintos criterios, la pareja debería pedir una hipoteca a tipo fijo.

```{r}
# Dibujos de Hurwicz
dibuja.criterio.Hurwicz(tabla_2, TRUE)

```

Observando el gráfico, se aprecia  que la alternativa de hipoteca fija es óptima para alfas menores a 0.4 y la variable es mejor a a partir de este nivel.

\newpage

```{r}
source("teoriadecision_funciones_incertidumbre.R")
```

# Problemas Alejandro Jurado Luque

## Problema 1: Tabla de Decisión

| Opciones | $E_1$ | $E_2$ | $E_3$ |
|:--:|:--:|:--:|:--:|
| $A_1$ | 800 | 400 | -200 |
| $A_2$ | 500 | 500 | 100 |
| $A_3$ | 300 | 450 | 300 |

### Apartados de Resolución (Funciones R Individuales)

a)  **Situación Favorable (Ganancias/Beneficios):** Asumiendo que los valores de la tabla representan **ganancias** (en miles de euros)
```{r}
#| echo: false

vector_p1 = c(800, 400, -200, 500, 500, 100, 300, 450, 300)
alternativas_p1 = c('A1', 'A2', 'A3')
estados_p1 = c('E1', 'E2', 'E3')

tablaX1 = crea.tablaX(vector_p1,
                     numalternativas = 3,
                     numestados = 3,
                     nb_alternativas = alternativas_p1,
                     nb_estados = estados_p1)
print("Tabla de Decisión (en miles de €):")
kableExtra::kable(tablaX1) 
```

```{r}
#| echo: false
  
res_wald_fav = criterio.Wald(tablaX1, favorable = TRUE)
print("Alternativa Óptima (Maximin):")
print(res_wald_fav$AlternativaOptima)

res_opt_fav = criterio.Optimista(tablaX1, favorable = TRUE)
print("Alternativa Óptima (Maximax):")
print(res_opt_fav$AlternativaOptima)

res_hurwicz_fav = criterio.Hurwicz(tablaX1, alfa = 0.6, favorable = TRUE)
print("Alternativa Óptima (Hurwicz):")
print(res_hurwicz_fav$AlternativaOptima)

res_sav_fav = criterio.Savage(tablaX1, favorable = TRUE)
print("Alternativa Óptima (Savage):")
print(res_sav_fav$AlternativaOptima)

dibuja.criterio.Hurwicz(tablaX1, favorable = TRUE)
```

b)  **Situación Desfavorable (Costos):** Asumiendo que los valores de la tabla representan **costos** (en miles de euros).

```{r}
#| echo: false

res_wald_desf = criterio.Wald(tablaX1, favorable = FALSE)
print("Alternativa Óptima (Minimax - Costos):")
print(res_wald_desf$AlternativaOptima)

res_opt_desf = criterio.Optimista(tablaX1, favorable = FALSE)
print("Alternativa Óptima (Minimin - Costos):")
print(res_opt_desf$AlternativaOptima)

res_hurwicz_desf = criterio.Hurwicz(tablaX1, alfa = 0.6, favorable = FALSE)
print("Alternativa Óptima (Hurwicz - Costos):")
print(res_hurwicz_desf$AlternativaOptima)

res_sav_desf = criterio.Savage(tablaX1, favorable = FALSE)
print("Alternativa Óptima (Savage - Costos):")
print(res_sav_desf$AlternativaOptima)

dibuja.criterio.Hurwicz(tablaX1, favorable = FALSE)
```

------------------------------------------------------------------------

## Problema 2: Decisión de Cultivo en Almería (Situación Real)

Una empresa agrícola está considerando tres alternativas de cultivo (Tomates, Pimientos, Cebollas) para el próximo año agrícola. En Almería, el clima afecta directamente a las rentabilidades de los cultivos, pudiendo darse 3 escenarios ($E_1$: Sequía, $E_2$: Clima Óptimo, $E_3$: Lluvias torrenciales), sobre el cual no se puede hacer una predicción. La rentabilidad de los cultivos por hectárea (en miles de €) depende de estas casuísticas.

| Opciones | $E_1$: Sequía | $E_2$: Óptimo | $E_3$: Lluvias torrenciales |
|:--------:|:-------------:|:-------------:|:---------------------------:|
|  Tomate  |      20       |      100      |             40              |
| Pimiento |      40       |      80       |             50              |
| Cebolla  |      50       |      60       |             60              |

### Apartado de Resolución (Función R Única)

```{r}
#| echo: false
vector_p2 = c(20, 100, 40, 40, 80, 50, 50, 60, 60)
alternativas_p2 = c('Tomate', 'Pimiento', 'Cebolla')
estados_p2 = c('E1_Sequia', 'E2_Optimo', 'E3_Lluvias')

tablaX2 = crea.tablaX(vector_p2,
                     numalternativas = 3,
                     numestados = 3,
                     nb_alternativas = alternativas_p2,
                     nb_estados = estados_p2)

print("Matriz de Decisión (en miles de €):")
kableExtra::kable(tablaX2)
```

a)  Asumiendo que los valores de la tabla representan **ganancias** (en miles de euros), aplique la **función R única** que devuelve la resolución de todos los métodos de decisión bajo incertidumbre en una sola tabla para determinar la alternativa óptima. Considere un coeficiente de optimismo $\alpha = 0.5$.

```{r}
#| echo: false

res_p2 = criterio.Todos(tablaX2, alfa = 0.5, favorable = TRUE)
print("Tabla de Resultados de Criterios (Alfa = 0.5):")
res_p2

alt_equilibrada = res_p2[nrow(res_p2), "Veces Optima"]

print("Alternativa Óptima más Equilibrada (por Frecuencia):")
print(alt_equilibrada)
```

\newpage


\newpage

# Soluciones Pablo Valdés

# Problema 1. 

## Apartado A. Caso favorable (beneficios)

```{r}
tb1a <- crea.tablaX(c(8, -2, 5,
                      4, 3, 6,
                      10, -6, 1,
                      7, 2, 2),
                    numalternativas = 4, numestados = 3,
                    nb_alternativas = c("A1","A2","A3","A4"),
                    nb_estados = c("E1","E2","E3"))

# Aplicamos los distintos criterios de decisión
wald_a <- criterio.Wald(tb1a, favorable = TRUE)
optimista_a <- criterio.Optimista(tb1a, favorable = TRUE)
hurwicz_a <- criterio.Hurwicz(tb1a, alfa = 0.4, favorable = TRUE)
savage_a <- criterio.Savage(tb1a, favorable = TRUE)
laplace_a <- criterio.Laplace(tb1a, favorable = TRUE)
puntoideal_a <- criterio.PuntoIdeal(tb1a, favorable = TRUE)
```

En una situación de beneficios, el **criterio de Wald** recomienda ser precavido, eligiendo la alternativa que asegure el mejor de los peores resultados.  
El **criterio optimista** prioriza el máximo beneficio posible.  
El **criterio de Hurwicz** equilibra ambos según el coeficiente α = 0.4, y los métodos de **Savage**, **Laplace** y **Punto Ideal** permiten contrastar la decisión final.  

```{r}
sol1a <- criterio.Todos(tb1a, alfa = 0.4, favorable = TRUE)
tt(sol1a, rownames = TRUE)
```

```{r}
dibuja.criterio.Hurwicz_Intervalos(tb1a, TRUE)
```

**Conclusión:**  
En el caso favorable, la alternativa **A2** resulta ser la más coherente, ya que ofrece un equilibrio entre seguridad y beneficio y aparece como óptima en varios de los criterios aplicados (Wald, Hurwicz y Laplace).  
Por tanto, la empresa debería escoger **A2** si espera un entorno de beneficios.  

---

## Apartado B. Caso desfavorable (costes)

```{r}
tb1b <- tb1a

wald_b <- criterio.Wald(tb1b, favorable = FALSE)
optimista_b <- criterio.Optimista(tb1b, favorable = FALSE)
hurwicz_b <- criterio.Hurwicz(tb1b, alfa = 0.4, favorable = FALSE)
savage_b <- criterio.Savage(tb1b, favorable = FALSE)
laplace_b <- criterio.Laplace(tb1b, favorable = FALSE)
puntoideal_b <- criterio.PuntoIdeal(tb1b, favorable = FALSE)

sol1b <- criterio.Todos(tb1b, alfa = 0.4, favorable = FALSE)
tt(sol1b, rownames = TRUE)
```

```{r}
dibuja.criterio.Hurwicz(tb1b, FALSE)
```

**Conclusión:**  
En la situación desfavorable (costes), la alternativa **A1** se considera la más prudente, pues minimiza los riesgos y aparece con frecuencia como la mejor opción bajo criterios conservadores como Wald y Savage.  
Por tanto, si el contexto es incierto o con tendencia a pérdidas, **A1** sería la elección más razonable.  

---

# Problema 2.

## Resolución (caso favorable)

```{r}
tb2 <- crea.tablaX(c(3,7,4,
                     2,6,6,
                     4,5,8,
                     1,4,10),
                   numalternativas = 4, numestados = 3,
                   nb_alternativas = c("B1","B2","B3","B4"),
                   nb_estados = c("E1","E2","E3"))

sol2 <- criterio.Todos(tb2, alfa = 0.5, favorable = TRUE)
tt(sol2, rownames = TRUE)
```

**Conclusión:**  
Los resultados muestran que la alternativa **B3 (precio estándar)** es la más sólida y estable, siendo elegida como óptima en varios criterios, especialmente en Hurwicz y Laplace.  
Por tanto, la librería debería optar por **mantener un precio estándar**, ya que proporciona un equilibrio adecuado entre riesgo y rentabilidad frente a la incertidumbre del mercado.